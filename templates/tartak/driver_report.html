{% extends '_base.html' %}
{% load static %}

{% block content %}

    <div class="index">

    <div class="container theme-showcase" role="main">

      <div class="page-header">
        <h1>Raport dla kierowcy</h1>
      </div>

    {% if form_valid %}

        <h2>{{ driver }}</h2>

        <br>

    <table class="table">
        <tbody>
            <tr>
                <td>Od</td>
                <td>{{ date_from }}</td>
            </tr>
            <tr>
                <td>Do</td>
                <td>{{ date_to }}</td>
            </tr>
            <tr>
                <td>Dostawy pośrednie - łączna masa [m³]</td>
                <td>{{ shipments_amount }}</td>
            </tr>
            <tr>
                <td>Dostawy końcowe - łączna masa [m³]</td>
                <td>{{ final_shipments_amount }}</td>
            </tr>
            <tr>
                <td>Dostawy łącznie - masa [m³]</td>
                <td>{{ whole_amount }}</td>
            </tr>
        </tbody>
    </table>

        <h2>Dostawy pośrednie</h2>
        {% if shipment_list %}
        <table class="table">
            <thead>
                <tr>
                    <th>Sortyment</th>
                    <th>Masa [m³]</th>
                    <th>Kontrahent</th>
                    <th>Data</th>
                </tr>
            </thead>
            <tbody>
            {% for shipment in shipment_list %}
                <tr>
                    <td>{{ shipment.wood_kind }}</td>
                    <td>{{ shipment.get_amount_display }}</td>
                    <td>{{ shipment.contractor }}</td>
                    <td>{{ shipment.order.date }}</td>
                </tr>
            {% endfor %}
          </tbody>
          </table>
        {% else %}
            <div class="panel panel-info">
              <div class="panel-heading">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true" ></span> Ten kierowca nie ma żadnych dostaw pośrednich w tym okresie.
              </div>
            </div>
        {% endif %}

        <h2>Dostawy końcowe</h2>
        {% if final_shipment_list %}
        <table class="table">
            <thead>
                <tr>
                    <th>Sortyment</th>
                    <th>Masa [m³]</th>
                    <th>Kontrahent</th>
                    <th>Rodzaj drewna</th>
                    <th>Kierowca</th>
                    <th>Data</th>
                </tr>
            </thead>
            <tbody>
            {% for final_shipment in final_shipment_list %}
                <tr>
                    <td>{{ final_shipment.wood_kind }}</td>
                    <td>{{ final_shipment.get_amount_display }}</td>
                    <td>{{ final_shipment.contractor }}</td>
                    <td>{{ final_shipment.wood_type }}</td>
                    <td>{{ final_shipment.driver }}</td>
                    <td>{{ final_shipment.date }}</td>
                </tr>
            {% endfor %}
          </tbody>
          </table>
        {% else %}
            <div class="panel panel-info">
              <div class="panel-heading">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true" ></span> Ten kierowca nie ma żadnych dostaw końcowych w tym okresie.
              </div>
            </div>
        {% endif %}

    <a href="{% url 'driver_report' %}" class="btn btn-info">
            <span class="glyphicon glyphicon-list" aria-hidden="true"></span> Zobacz raport innego kierowcy
        </a>
        <a href="{% url 'reports' %}" class="btn btn-info">
            <span class="glyphicon glyphicon-list" aria-hidden="true"></span> Wróć do raportów
        </a>

    {% else %}

    <p>Wybierz daty oraz kierowce</p>

    <form method="get" action="{% url 'driver_report' %}">
        {% csrf_token %}

        {% include 'forms/form_hidden_fields.html' with fields=form.hidden_fields %}
        {% include 'forms/form_fields.html' with fields=form.visible_fields %}

        <input class="btn btn-default"  type="submit" value="Generuj raport" />
        <a href="{% url 'reports' %}" class="btn btn-info">
            <span class="glyphicon glyphicon-list" aria-hidden="true"></span> Wróć do raportów
        </a>
    </form>

    {% endif %}



    </div> <!-- /container -->

    </div>

{% endblock %}